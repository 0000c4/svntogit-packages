# $Id$
# Maintainer: St√©phane Gaudreault <stephane@archlinux.org>
pkgname=serf
pkgver=1.2.1
pkgrel=2
pkgdesc="High-performance asynchronous HTTP client library"
url="http://code.google.com/p/serf/"
arch=('i686' 'x86_64')
license=('Apache')
depends=('apr' 'apr-util' 'openssl' 'zlib')
source=(http://serf.googlecode.com/files/${pkgname}-${pkgver}.tar.bz2)
sha1sums=('f65fbbd72926c8e7cf0dbd4ada03b0d226f461fd')
options=('!libtool')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  ./configure --prefix=/usr --with-apr=/usr --with-apr-util=/usr --with-openssl=/usr
  sed -i 's/ldb-5.3/ldb/' Makefile serf.pc
  make
}

check() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  make check
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  make DESTDIR="${pkgdir}" install
  rm "${pkgdir}"/usr/lib/libserf-1.a
}
