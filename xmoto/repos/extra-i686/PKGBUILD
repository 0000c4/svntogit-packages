# $Id$
# Maintainer: Ronald van Haren <ronald.archlinux.org>
# Contributor: Travis Willard <travisw@wmpub.ca> 
# Contributor: Denis (dtonator@gmail.com)

pkgname=xmoto
pkgver=0.4.2
pkgrel=3
pkgdesc="A challenging 2D motocross platform game, where physics play an important role."
arch=('i686' 'x86_64')
url="http://xmoto.tuxfamily.org"
license=('GPL')
depends=('bzip2' 'libjpeg' 'libpng' 'lua' 'sdl_mixer' 'ode=0.10.1' 'curl>=7.16.2' 
	 'mesa' 'libxdamage' 'libxfixes' 'sqlite3' 'sdl_ttf' 'desktop-file-utils')
install=xmoto.install
source=(http://download.tuxfamily.org/$pkgname/$pkgname/$pkgver/$pkgname-$pkgver-src.tar.gz \
	ode-0.10.patch )
md5sums=('15368b282641a225b71c279fe4dc0dc4'
         'b495d067fa7375099c8d30ebf11ee973')

build() {
  cd $srcdir/xmoto-$pkgver

# patch to build with 0de 0.10
  patch -Np1 < $srcdir/ode-0.10.patch || return 1

  ./configure --prefix=/usr || return 1
  make || return 1
  make DESTDIR=$startdir/pkg mangdir=/usr/share/man/man6 install || return 1

  #install desktop file
  install -Dm0644 $srcdir/xmoto-${pkgver}/extra/xmoto.desktop \
	$pkgdir/usr/share/applications/xmoto.desktop

  #install icon for desktop file
  install -Dm0644 $srcdir/xmoto-${pkgver}/extra/xmoto.xpm \
	$pkgdir/usr/share/pixmaps/xmoto.xpm
}

