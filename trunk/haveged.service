[Unit]
Description=Entropy Daemon based on the HAVEGE algorithm
Documentation=man:haveged(8) http://www.issihosts.com/haveged/
DefaultDependencies=no
ConditionVirtualization=!container
Before=sysinit.target shutdown.target systemd-journald.service

[Service]
ExecStartPre=+/usr/bin/sysctl -w kernel.random.write_wakeup_threshold=1024
ExecStart=/usr/bin/haveged --Foreground --verbose=1
Restart=always
SuccessExitStatus=137 143
DynamicUser=on
AmbientCapabilities=CAP_SYS_ADMIN
NoNewPrivileges=on
PrivateDevices=on
PrivateNetwork=on
PrivateTmp=on
ProtectSystem=full
ProtectHome=on

[Install]
WantedBy=sysinit.target
