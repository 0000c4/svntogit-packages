# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>

pkgname=tzdata
pkgver=2008i
pkgrel=1
_tzcode=2008h
_tzdata=2008i
pkgdesc="Sources for time zone and daylight saving time data"
arch=('i686' 'x86_64')
url="http://www.twinsun.com/tz/tz-link.htm"
license=('GPL')
groups=('base')
depends=()
makedepends=()
options=()
source=(ftp://elsie.nci.nih.gov/pub/tzcode${_tzcode}.tar.gz \
        ftp://elsie.nci.nih.gov/pub/${pkgname}${_tzdata}.tar.gz \
        Makefile.patch)
md5sums=('2f0fc8b1227bd7289483f64e8a194ed9'
         'b659aac215ca5d1ef43c596cfb561252'
         'a64ed97d1fc03c66ee8612c0d9f40507')

build() {
  cd ${srcdir}/
  if [ "$CARCH" = "x86_64" ]; then
      CFLAGS="-march=x86-64 -mtune=generic -O1 -pipe -Wall"
    else CFLAGS="-march=i686 -mtune=generic -O1 -pipe -Wall"
  fi

  tar -xf tzcode${_tzcode}.tar.gz  || return 1
  tar -xf ${pkgname}${_tzdata}.tar.gz || return 1

  patch -Np1 -i ../Makefile.patch || return 1

  make || return 1
  make DESTDIR="${pkgdir}" install

  rm ${pkgdir}/usr/share/zoneinfo/localtime
}
