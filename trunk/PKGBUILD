# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Contributor: Jan Jezek <honzin.jezek@gmail.com>

pkgname=tumbler
pkgver=0.1.6
pkgrel=2
pkgdesc="D-Bus service for applications to request thumbnails"
url="http://git.xfce.org/apps/tumbler/"
license=('GPL2' 'LGPL')
arch=('i686' 'x86_64')
groups=('xfce4')
depends=('poppler-glib' 'dbus-glib' 'ffmpegthumbnailer')
#optdepends=('raw-thumbnailer: support for Raw Digital Camera Images'
#	'dcraw: support for Raw Digital Camera Image')
makedepends=( 'intltool' 'gtk-doc') # 'tumbler') # \ - broken, needs tumbler to build itself
options=('!libtool')
source=(http://archive.xfce.org/src/apps/${pkgname}/0.1/${pkgname}-${pkgver}.tar.bz2)
md5sums=('ce273623d83aac927d5c2dabbb7993cb')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  ./configure --prefix=/usr \
	--sysconfdir=/etc \
	--libexecdir=/usr/lib/xfce4 \
	--disable-static \
	--disable-debug \
#	--enable-gtk-doc # \ - broken, needs tumbler to build itself
	
  # Remove rpaths.
  sed -i 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' libtool
  sed -i 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' libtool
  make
}

package() {
  cd ${srcdir}/${pkgname}-${pkgver}
  make DESTDIR=$pkgdir install
}
