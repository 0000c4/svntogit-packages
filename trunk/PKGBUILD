# $Id$
# Maintainer: AndyRTR <andyrtr@archlinux.org>
# Contributor: Gerhard Brauer <gerbra@archlinux.de>
# Contributor: Richard Murri <admin@richardmurri.com>

pkgname=x2goclient
pkgver=4.0.0.1
pkgrel=1
pkgdesc="x2go qt4 client"
arch=('i686' 'x86_64')
license=('GPL')
url="http://www.x2go.org"
depends=('qt' 'libldap' 'libcups' 'nxproxy' 'libssh' 'libxpm')
makedepends=('man2html')
#options=('!makeflags')
source=(http://code.x2go.org/releases/source/${pkgname}/${pkgname}-${pkgver}.tar.gz)
md5sums=('e8786329cfe97652d337f71caa71f432')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
#  ln -s ${srcdir}/${pkgname}-${pkgver}/x2go-logos/x2go-logo.svg ${srcdir}/${pkgname}-${pkgver}/svg/x2gologo.svg

  #sed -i 's/linux-g++/unix/g' x2goclient.pro
#  qmake x2goclient.pro
#return 1

#  make clean
  sed -i "s:qmake-qt4:qmake:g" Makefile
  make PREFIX=/usr #build_client
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  make PREFIX=/usr DESTDIR="$pkgdir" install #build_client install

  # install client binary
  install -D -m755 x2goclient $pkgdir/usr/bin/x2goclient

  # install icons
  install -D -m644 icons/128x128/x2goclient.png $pkgdir/usr/share/x2goclient/icons/x2goclient.png
  install -D -m644 icons/128x128/x2goclient.png $pkgdir/usr/share/pixmaps/x2goclient.png
  install -D -m644 icons/16x16/x2goclient.png $pkgdir/usr/share/icons/hicolor/16x16/apps/x2goclient.png
  install -D -m644 icons/32x32/x2goclient.png $pkgdir/usr/share/icons/hicolor/32x32/apps/x2goclient.png
  install -D -m644 icons/64x64/x2goclient.png $pkgdir/usr/share/icons/hicolor/64x64/apps/x2goclient.png
  install -D -m644 icons/128x128/x2goclient.png $pkgdir/usr/share/icons/hicolor/128x128/apps/x2goclient.png

  # install desktop entry
  install -D -m644 desktop/x2goclient.desktop $pkgdir/usr/share/applications/x2goclient.desktop
}
