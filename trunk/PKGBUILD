# Contributor: judd <jvinet@zeroflux.org>

pkgname=alsa-lib
pkgver=1.1.7
pkgrel=2
pkgdesc="An alternative implementation of Linux sound support"
arch=('x86_64')
url="http://www.alsa-project.org"
depends=('glibc')
optdepends=('python2: for python smixer plugin')
makedepends=('python2')
license=('LGPL')
source=(ftp://ftp.alsa-project.org/pub/lib/$pkgname-$pkgver.tar.bz2
        fix_streams.patch::'http://git.alsa-project.org/?p=alsa-lib.git;a=patch;h=b420056604f06117c967b65d43d01536c5ffcbc9')
sha512sums=('7cc81464d876a137e9ac9700420bfff7cd528338bdc6e0bdbe313d45c5b97c81f1a9483df0556fe390d54a9db747fbec62e843b42d2cbc740d5a91b015714f6c'
            '0d05f7cf9c09124107765b5d831be66fd669672e8afc1a591d2b637f4e3e17a1ae668a3ca0db93f51863bc5dd72a4fde6a13eef014b43a7688898856e885d7a1')

prepare() {
  cd $srcdir/$pkgname-$pkgver
  patch -p1 < ../fix_streams.patch  # FS60591
}

build() {
  cd "$srcdir/$pkgname-$pkgver"
  ./configure --without-debug --prefix=/usr --with-pythonlibs="-lpthread -lm -ldl -lpython2.7" --with-pythonincludes=-I/usr/include/python2.7
  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir" install
}
