# $Id$
# Maintainer: arjan <arjan@archlinux.org>
# Contributor: Tom Newsom <Jeepster@gmx.co.uk>
pkgname=imlib2
pkgver=1.4.1
pkgrel=1
pkgdesc="Imlib2 is the successor to Imlib. It is NOT a newer version -- Imlib 2 can be installed alongside Imlib 1.x"
arch=(i686 x86_64)
url="http://sourceforge.net/projects/enlightenment"
license=('BSD')
depends=('libtiff' 'libungif' 'bzip2' 'freetype2' 'libxext' 'libpng' 'libid3tag')
options=('!libtool')
source=(http://downloads.sourceforge.net/sourceforge/enlightenment/$pkgname-$pkgver.tar.gz)
md5sums=('16a3d885e523303be794282c0ed90841')

build() {
  cd $startdir/src/$pkgname-$pkgver

  # Enable x86 MMX optimizations for i686 (32-bit assembler code not compatible with x86_64)
  [ "${CARCH}" = "i686" ] && EXTRAOPTS="--disable-mmx"
  # Disable AMD64 optimizations due to bug in assembler code
  [ "${CARCH}" = "x86_64" ] && EXTRAOPTS="--disable-amd64"

  ./configure --prefix=/usr --sysconfdir=/etc/imlib2 --x-libraries=/usr/lib $EXTRAOPTS
  make || return 1
  make DESTDIR=$startdir/pkg install
  install -D -m644 COPYING $startdir/pkg/usr/share/licenses/$pkgname/LICENSE.txt
}
