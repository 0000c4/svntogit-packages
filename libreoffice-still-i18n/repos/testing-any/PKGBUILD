# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-still-i18n

pkgver=5.1.6
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('5a30d57a576ec71f93ce8079413342ad'
         '6b6f24ab414a47997912032a8cbd1bc7'
         '9742cb61fbc2ef6bc40d2f8f23eaf61b'
         'b29cc72fde618d4dba2ea9dd6bb28bb1'
         'f1d829a0c40fd2761d36ffd3bfc1414e'
         'b4bb9087c145ac18b578b1ffda95105c'
         '06d281799bc0849b7b43808db9ab43bb'
         'f2428a42b0ea238570890657dfd97207'
         'd76abc59c35d41f2b4bf6f10e47534c1'
         '6d86a790e2883d351ccca6d508856527'
         '6f5a390d059d1bb201287111facd185a'
         '39c4eb07f8c89ee37759c1d72ce604e6'
         'ebac1cadf1ae30d5553f2677421026da'
         'de433d9f8a93917c6ad69b9e8d97c89a'
         '1a5b951932d9c9a929c0dcb6ffb4a89f'
         '63d1dbfb9dda6f39bf12f8ad620853a2'
         '64afb62f8e9ca44974e0fc776928d859'
         'b4930384fcf15efdc99f8eede99ad7e7'
         '8dd04e6faa7edd8ae9ab4953e3eac5b8'
         '84f907d8aa0a30cfe4b317ad0bfccd13'
         '69f23e74a361d05400ff489936cf7e49'
         '71aab84e9afbd64e9ae0a28bbb089aa5'
         'e7df6394e27d682a417394145ac93faf'
         '0d92694fb34013db96be5ca0fe808795'
         'ce10cf23bc0be0a805bb4267e8fc54e3'
         '87f09323ea6e6ce168ec14f5e963b466'
         '2c628c16e857ecdda1d3fedbe293859b'
         '7d652cc35fa06d9c25879a19b87870c3'
         'fc6fd5e82abc6e334a8af57590f6f18f'
         'd88c10a1748b5237e4b3ff0060ade71f'
         '113ae61cc0ae0f52cb257209dac4f1ac'
         'b4964c57aa296264a76b2859c1b788d2'
         'ae81f101c5e599c3d0d25e860d9fa47f'
         '2095514f883dda900722703fca769cb6'
         '1c31943863370d89f049863fbc66e7e1'
         '17cb99597437fce5d1521013a0cc6203'
         '66d7d8ff0795c8d3d5925aa347bac6da'
         '281c6a2f64ce55cfac8239cd8d73911f'
         '73706628da392f60a7951c8701a91521'
         '6b61097d6b4995927143b61f41d1fff8'
         'c6b62bdb39fe4c47f02a551d80507064'
         'e6bd72c396bc2d7fb0672717e2c7404c'
         'b7f35d206f78eaf7b06c50f297c4c271'
         '0f42b7b649b1037a1aee40b3468b5d8f'
         '3d285ba94700f284ea2e735e6230eda1'
         'e48c4d7960d61ab47cfd4211a6c7fbd0'
         '80383e1ce11b3fbd1c68fef57ac0ffb8'
         '876f44ade07f6913a1da68b9879a7b56'
         'af0050d6edca018dae9b125362809dad'
         'f77ec90dd8b103ed039496ea44ad681a'
         '8b571cead6aac17f3fc7c60aa21e079d'
         'abd3f47d1fc604a08a26d57e5e8869ac'
         'e2541cdd919bce1bc9eba203ef84db89'
         '770ba6cf385a8bc9e7afb9196f1bdcff'
         '88205442b625971fb4b6824025915417'
         'd6d91c44daf4be4f5edc22bb03fc73a6'
         '2c702965e95980263e0ec95d813f5a66'
         'a5aea8c3f0e11bdd998518566b85f901'
         '52af0e28a76344ef8825d53958db1531'
         '0ec835efc4d3680874634e674be5b0be'
         '2a539a44f69587dcdd4c9932bee20a08'
         '7291ce56c91cc4cd41cb998e4d72d08f'
         '4fbabf260ac1df93950a8961465ef616'
         '7b87da451735ed50576123860f1a4cce'
         'b671d791be001ac0da5a32edcfc7885b'
         'c34855d21d5db8db6a3a1435c817ea58'
         '0c3b342bf8538aefd5b2d3e2d248227d'
         '0d4f6456edd2d1f2f72c10ffacb4258b'
         'e5cf745909c3bdae82d0183a4d5f4373'
         '7d9a7c1a0ed42090b93ac42d6779f3b3'
         'ddcce3f1a86dac41ed979d035f634abe'
         '7a8908a08cc51a8e2b2f61d12af54b9a'
         '3e7f55a283d8c82e2db774817c7529ab'
         '0daab5308ca61dcfea0885b580228081'
         'd5d7bb95e129f05a52562ca1d0d7a4a6'
         '48d55a6b58a7f2a0f57d62fd58b8f46b'
         '69e9548e172511be6dd618bf0b7b15ad'
         '6c87985c98c5aafb90487b41c9943936'
         'b819d725f778d017dc8135668ba62ce6'
         '359c829305ebebb0fc30ab7668505ca5'
         '0633508808b10044a22ab9e74016fe1c'
         'f948596f3d05e6cc4281af0b3cf4b5ec'
         '016c9a08415e13cb916ee1e1910b52ac'
         'ecb7d94fb5cac2b3f52c6ebd9ac3f12e'
         'b32c156f419f30fba0f17084bf31fd88'
         '8a98776fe71b5f72635d76316ab068ec'
         '9a166cdae5f2e2616741d3eafaa17181'
         '0b6bb798de27cbde7bcdd4a552448b02'
         '59030de9ea3eabf30d96c71006ac8bb6'
         'e6996e8fc25219fc6bf6c2216b351c71'
         '70a33c2625d81e4f8bb1a90bdc191d19'
         '22576f6f27537f51f35b0ec5ab3f3bdc'
         '92f7d72817db022ad680e160eda2127d'
         '29bf8b7aee21f26a759c98d4d27f7cdf'
         '3830b2203853c377f914b179e9a2c65e'
         'd3863c2a0d4a1f4a1917b5318aefa723'
         '6e6dfbace68baf1d9bca82fca574de74'
         '8853dedfe09ca0b72508a1fd5d9d4906'
         '77ad5d58053b20669dda541f90fb82e8'
         '15461ba70f50220d18e1c69bd86b5931'
         '8136f2ba7c613194267d7c4c5bbfa306'
         '29a0275d737b296c59be93c24e22081b'
         '01ac4840c61707b05c01aaa7980de0a1'
         'f1780a10d708218f3c5a7e7eca522854'
         '1aa4493808887ebeaf1cdf5a58b8b1cd'
         '6ae0c5ef3b55ebf585c7afb567d0380c'
         'a8d13215680e90dd2058342f4da557a5'
         '6052d302237c04855181fe46555c0763'
         '4ed31da5c253d38745ba894649894dbe'
         'fe845b023f580fba0a237e97f31fc836'
         '47d09bc69a354c4669729b881e470048'
         '5db435421b0db78da008bcaa3e23a7fe'
         'ae5c3a671ba1c805c97fd92e26cc9c94'
         'c4154034fd0bbcec6a0e089b2d0305d4'
         '24d04077ea24560955ae63261d8cada9'
         '607983504acd7504115c34ab9d42f504'
         'a0755f4cb1359b9c48363f36bbdeda0a'
         '5fbfb180d0f9c9f0c89699c60e9eceb3'
         '0fb1793d785aaefc42e08cb0602cf62a'
         'c2ba2c42b058f76591c1c028042fe3aa'
         '4d1f8bd7716128c6ecaef3d436bc9cbc'
         'c7e6a5152c148ab39ca2e57db2d875b3'
         '22e1dad8891b33d3e046c44d15838aa6'
         '1a39f3115fb25a706e358a508b08c0b7'
         '4a36d589ae580e7c200a15dc25123e3b'
         '3e674e041d024731827b12faa82d016e'
         '0eb4fca99f1ccc1d5a942bea11695a88'
         'ca1a7992d5a983b14c255caeb709a0c4'
         '67e2c94e1e9400ba8c38e3bab408fc9e'
         'f7e87fbd0fec5f59fd8d7caac6f8582f'
         '9c6769ce02158fcbe5c1759662de99df'
         'df67d8c9f127d2194ae7936a93d4186b'
         '5a4c191f42e0cc7526ac37ab8c37220a'
         '5057810ed3a53e5ddeebbdd171c2ec9a'
         'aa78135679b7bc873f3695610759d19e'
         '091c5bbbbaf0e9bddd7c3130d5f3146f'
         '974a5cd9d4bd98f24d624e6ce026bc82'
         '9ddcfaaff14658606a1dd05b25aca88f'
         '13498a6daeab3d02bb13fdc3891f6045'
         '5b8d37d69251636ceb7bec9958a4ec87'
         '24362f29131284ca040065269265b842'
         '83f046af7661743361b1a1453fcbb776'
         'e30c24b089164987ba0e625261a7c93b'
         'fe6abc81a52149747725ed47d13062dd'
         '4a66eb17ee015636c8239833820e1dfa'
         '82cefcdec884ee0acbb45fbfdd8f0cc1'
         '2bd8170eac18c169a7f7626ea1119888'
         'b96806de2338f0be3fee193611450297'
         'b4405a741892cf9e2c3c5795d1c59b94'
         '199e9cd8040bc319861d56a13009ab80'
         '27b02624d121d3a0c9f27261d55bfa37'
         'b59f96eb6269206827a468bd8351d354'
         'e11f0b1e6a02b4a70c1cd27cfc11a8d2'
         'c8fa9af2679d26176e82a71e88962584'
         '8a0293e53a894ffc93bdf67532588979'
         'caa082be450df673e6edc43c2a12caea'
         '547250e2359c9c6cd51f4658f43177d8'
         'f7d6f152fee5baa94321fd3f443fb602'
         '776508a1dba17543972ee240cbb0ae00'
         'ce7ea000f39983b1c730d4abb1f8070f'
         '1b67848b0dd976d1be2aebc65a147ccf'
         'e46d0b56472a6627ff83be4b433f5ae1'
         'a2e0d5dbebcbd5c37a4f7a5278126818'
         '93657d1fc21477ceb14c1c81ab1da8ec'
         '98f4e71eb5888ab3610d4b2b8a8e693c'
         '8603db7dc66627d0e5c76ac064d619d6'
         '47c013cfb4527e35fb484359038940cd'
         '765df83dba5c87b66cc37b83657bb702')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still"
  depends=('libreoffice-still')
  provides=("libreoffice-$1")
  conflicts=("libreoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
