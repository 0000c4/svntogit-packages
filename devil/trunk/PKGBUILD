# $Id$
# Maintainer: damir <damir@archlinux.org>
# Contributor: TheHoff <forums>

pkgname=devil
pkgver=1.7.5
pkgrel=3
pkgdesc="Library for reading several different image formats"
arch=(i686 x86_64)
url="http://openil.sourceforge.net/"
depends=('allegro>=4.2.2' 'sdl' 'libpng' 'zlib' 'libjpeg' 'libtiff' 'libmng')
makedepends=('bash')
options=('!libtool' '!docs')
license=('GPL')
source=(http://downloads.sourceforge.net/sourceforge/openil/DevIL-$pkgver.tar.gz
        00_endian_and_ILvoid_fixes.diff  
        01_fix_as-needed.diff
        02_add_missing_files.diff  
        03_CVE-2008-5262.diff)

build() {
   cd $startdir/src/devil-$pkgver

    # Patchs from debian
    patch -Np1 < ../00_endian_and_ILvoid_fixes.diff
    patch -Np1 < ../01_fix_as-needed.diff
    patch -Np1 < ../02_add_missing_files.diff
    patch -Np1 < ../03_CVE-2008-5262.diff

   # configure and build
   ./configure --prefix=/usr --enable-ILU --enable-ILUT --enable-opengl --enable-sdl
   make || return 1
   make prefix=$startdir/pkg/usr install   
}
md5sums=('2a74578507a21d75d7fcc5afd41444d0'
         '7d935399e56cf58e8f3545cea952e3e4'
         'a3254fbd1829fc1ae1b8b9a3fee6d4ae'
         'b82c7b98f71b1f01c5dae0e110ef84e5'
         '66c7f735d4eea4968e6785ded95d3581')
