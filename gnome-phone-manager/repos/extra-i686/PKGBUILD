# $Id$
# Maintainer: Roman Kyrylych <roman@archlinux.org>

pkgname=gnome-phone-manager
pkgver=0.66
pkgrel=1
pkgdesc="Control your mobile phone from your GNOME desktop."
arch=('i686' 'x86_64')
url="http://live.gnome.org/PhoneManager"
license=('GPL')
depends=('evolution-data-server' 'gnokii' 'gnome-bluetooth' 'gnome-icon-theme' 'libcanberra')
makedepends=('intltool' 'gnome-common')
options=('!emptydirs' '!libtool')
install=gnome-phone-manager.install
source=(http://ftp.gnome.org/pub/GNOME/sources/gnome-phone-manager/${pkgver}/${pkgname}-${pkgver}.tar.bz2
        git-update.patch
        gtk3.patch)
sha256sums=('a4a389b1086e59acf5771cce5b560510d633326053dae83c20d86c2d53164c35'
            '08d0db962b203d8e21e083a72a95b2625d2e649b25a3c0b8ba688ef517bf8638'
            '50af2e8becfba84b8ef7684a8e4351270dca863a0e2ff94df21ba834c02c78a1')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  patch -Np1 -i "${srcdir}/git-update.patch"
  patch -Np1 -i "${srcdir}/gtk3.patch"
  libtoolize --force
  autoreconf
  ./configure --prefix=/usr --sysconfdir=/etc \
      --localstatedir=/var --disable-static
  make
  make DESTDIR="${pkgdir}" GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 install

  install -m755 -d "${pkgdir}/usr/share/gconf/schemas"
  gconf-merge-schema "${pkgdir}/usr/share/gconf/schemas/${pkgname}.schemas" --domain gnome-phone-manager ${pkgdir}/etc/gconf/schemas/*.schemas
  rm -f ${pkgdir}/etc/gconf/schemas/*.schemas
}
