From: Christophe Giboudeaux <cgiboudeaux@gmx.com>
Date: Sat, 24 Nov 2012 20:53:56 +0000
Subject: Fix build with QJson >= 0.8.0
X-Git-Url: http://quickgit.kde.org/?p=kdepim-runtime.git&a=commitdiff&h=ca06d09b6b78381bb152deb02c31ecb9d6a43210
---
Fix build with QJson >= 0.8.0
---


--- a/resources/google/calendar/CMakeLists.txt
+++ b/resources/google/calendar/CMakeLists.txt
@@ -1,4 +1,9 @@
 set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${KDE4_ENABLE_EXCEPTIONS}")
+
+# QJson 0.8.0 is BIC
+if(QJSON_VERSION VERSION_GREATER 0.7.1)
+  add_definitions(-DUSE_QJSON_0_8)
+endif()
 
 set(calendarresource_SRCS
   calendareditor.cpp

--- a/resources/google/calendar/defaultreminderattribute.cpp
+++ b/resources/google/calendar/defaultreminderattribute.cpp
@@ -79,7 +79,11 @@
   }
 
   QJson::Serializer serializer;
+  #if !defined( USE_QJSON_0_8 )
   return serializer.serialize( list );
+  #else
+  return serializer.serialize( list, 0 );
+  #endif
 }
 
 Alarm::List DefaultReminderAttribute::alarms( Incidence *incidence ) const

