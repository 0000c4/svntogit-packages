# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
pkgbase=icedtea-web
pkgname=('icedtea-web' 'icedtea-web-doc')
pkgver=0.9.hg20110107
pkgrel=1
pkgdesc="provides a Free Software web browser plugin running applets written in the Java programming language and an implementation of Java Web Start, originally based on the NetX project"
arch=('i686' 'x86_64')
url="http://icedtea.classpath.org/wiki/IcedTea-Web"
license=('GPL2')
groups=()
depends=('openjdk6') # 'libx11' 'zlib'
makedepends=('zip' 'xulrunner')
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=(#$pkgname-$pkgver.tar.gz
	# latest snapshot from 1.0 release branch
	# see http://icedtea.classpath.org/hg/release/icedtea-web-1.0/rev/b3647620fa41 for state
	http://icedtea.classpath.org/hg/release/icedtea-web-1.0/archive/b3647620fa41.tar.bz2
        fix-man-location.patch)
noextract=()
md5sums=('0468c20ad57d1d1f5e5b490956301d8e'
         '1608d3141594a272d330db6adb64a572')

build() {
#  cd "$srcdir/$pkgname-$pkgver"

  _javaver=6
  _jvmdir=/usr/lib/jvm/java-${_javaver}-openjdk

  if [ "${CARCH}" = "x86_64" ]; then
    _arch=amd64
  else
    _arch=i586
  fi


  cd $srcdir/$pkgbase-*

  patch -Np1 -i $srcdir/fix-man-location.patch

  ./autogen.sh
  ./configure --prefix=/usr/lib/jvm/java-6-openjdk \
      --datarootdir=/usr/share
#	--disable-doc \
#	--disable-plugin #--help
  make
}

package_icedtea-web() {
#  cd "$srcdir/$pkgname-$pkgver"
  cd $srcdir/$pkgbase-*
  make DESTDIR="$pkgdir" install-exec-local
}

package_icedtea-web-doc() {
#  cd "$srcdir/$pkgname-$pkgver"
  cd $srcdir/$pkgbase-*
  install -m755 -d $pkgdir/usr/lib/jvm/java-6-openjdk/jre/lib
  make DESTDIR="$pkgdir" install-data-local
}

