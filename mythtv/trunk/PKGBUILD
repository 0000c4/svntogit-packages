# $Id$
# Contributor: <kleptophobiac@gmail.com>
# Contributor: dorphell <dorphell@archlinux.org>
# Maintainer: Juergen Hoetzel <juergen@archlinux.org>

pkgname=mythtv
pkgver=0.22
pkgrel=1
pkgdesc="A Homebrew PVR project"
arch=('i686' 'x86_64')
url="http://www.mythtv.org/"
license=('GPL2')
groups=('pvr')
depends=('bash' 'mysql-clients' 'qt' 'lame' 'lirc-utils' 'ffmpeg' 'libxvmc' 'fribidi')
backup=('etc/conf.d/mythbackend')
install=mythtv.install
source=(ftp://ftp.osuosl.org/pub/mythtv/${pkgname}-${pkgver}.tar.bz2 mythbackend)
md5sums=('e8f8b5b6a51cd7be700e215b2a1bf2c0' '0228c7b3aca06f04b7584913ebe76d68')

# 
build() {
   cd $srcdir/${pkgname}-${pkgver} 
   
   ARCH=${CARCH/_/-}
  ./configure --prefix=/usr --cpu=${ARCH} \
    --enable-mmx \
    --disable-audio-oss \
    --enable-audio-alsa \
    --disable-audio-jack \
    --disable-audio-pulse \
    --disable-audio-arts \
    --disable-vdpau \
    --enable-dvb \
    --enable-lirc \
    --enable-joystick-menu \
    --disable-firewire --enable-v4l \
    --enable-ivtv \
    --enable-dvb \
    --dvb-path=/usr/include/linux/dvb \
    --enable-xvmc \
    --enable-ffmpeg \
    --enable-xvmc-pro \
    --enable-xvmc-vld \
    --enable-opengl-vsync \
    --enable-firewire \
    --enable-fribidi 

   # build

   qmake mythtv.pro  
   make 

   # basic install
   make INSTALL_ROOT=$pkgdir install 
   
   install -D -m0755 $startdir/src/mythbackend $pkgdir/etc/rc.d/mythbackend 

   # config file 
   install -D -m644 $startdir/src/archlinux.conf.d.mythbackend $startdir/pkg/etc/conf.d/mythbackend
}
