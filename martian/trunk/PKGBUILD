# $Id$
# Maintainer:
# Contributor: Jonathan Liu <net147@hotmail.com>

pkgname=martian
pkgver=20080407
pkgrel=1
pkgdesc="Alternative driver for the Agere Systems PCI WinModem."
arch=('i686')
url="http://martian.barrelsoutofbond.org/"
license=("GPL" "custom:Agere Systems WinModem License")
depends=('kernel26>=2.6.25.3-1' 'kernel26<2.6.26' 'martian-utils')
replaces=('ltmodem')
options=(!strip)
install=martian.install 
source=(http://linmodems.technion.ac.il/packages/ltmodem/kernel-2.6/martian/martian-full-${pkgver}.tar.gz
        fastcall.patch
        stringify.patch)
md5sums=('11fc90f7522810a002b5632dccb0af5c'
         'ad11cd70747c4217122c12172bca4ad0'
         'b6b32f57e13d60f4427ba8361f52478a')
_kernver=2.6.25-ARCH
                  
build() { 
  cd $startdir/src/martian-full-$pkgver
  patch -Np1 -i ../fastcall.patch || return 1
  patch -Np1 -i ../stringify.patch || return 1
  make KERNEL_DIR=/usr/src/linux-${_kernver} all || return 1
  install -D -m644 $startdir/src/martian-full-$pkgver/kmodule/martian_dev.ko $startdir/pkg/lib/modules/${_kernver}/kernel/drivers/net/martian_dev.ko
  install -D -m644 $startdir/src/martian-full-$pkgver/modem/ASWMLICENSE $startdir/pkg/usr/share/licenses/$pkgname/LICENSE
}  
