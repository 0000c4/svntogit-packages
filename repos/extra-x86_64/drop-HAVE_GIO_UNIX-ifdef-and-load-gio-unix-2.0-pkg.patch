From a54bc42cb5f06f06141d8ed2434719bf7c200aaf Mon Sep 17 00:00:00 2001
From: Evangelos Foutras <evangelos@foutrelis.com>
Date: Sun, 23 Dec 2012 00:09:34 +0200
Subject: [PATCH] Drop HAVE_GIO_UNIX ifdef and load gio-unix-2.0 pkg

This restores exo-open's .desktop file launching functionality.
---
 configure.ac.in | 1 +
 exo-open/main.c | 9 ---------
 2 files changed, 1 insertion(+), 9 deletions(-)

diff --git a/configure.ac.in b/configure.ac.in
index 0c8b3a1..ec9be67 100644
--- a/configure.ac.in
+++ b/configure.ac
@@ -159,6 +159,7 @@ dnl *** Check for required packages ***
 dnl ***********************************
 XDT_CHECK_PACKAGE([GLIB], [glib-2.0], [2.30.0])
 XDT_CHECK_PACKAGE([GIO], [gio-2.0], [2.30.0])
+XDT_CHECK_PACKAGE([GIO_UNIX], [gio-unix-2.0], [2.30.0])
 XDT_CHECK_PACKAGE([GTK], [gtk+-2.0], [2.24.0])
 XDT_CHECK_PACKAGE([GTHREAD], [gthread-2.0], [2.30.0])
 XDT_CHECK_PACKAGE([LIBXFCE4UTIL], [libxfce4util-1.0], [4.10.0])
diff --git a/exo-open/main.c b/exo-open/main.c
index 059fad4..da78f6a 100644
--- a/exo-open/main.c
+++ b/exo-open/main.c
@@ -32,9 +32,7 @@
 
 #include <glib/gstdio.h>
 #include <gio/gio.h>
-#ifdef HAVE_GIO_UNIX
 #include <gio/gdesktopappinfo.h>
-#endif
 #include <exo/exo.h>
 
 
@@ -143,7 +141,6 @@ usage (void)
 static gboolean
 exo_open_launch_desktop_file (const gchar *arg)
 {
-#ifdef HAVE_GIO_UNIX
   GFile           *gfile;
   gchar           *contents;
   gsize            length;
@@ -191,12 +188,6 @@ exo_open_launch_desktop_file (const gchar *arg)
 #endif
 
   return result;
-#else /* !HAVE_GIO_UNIX */
-  g_critical (_("Launching desktop files is not supported when %s is compiled "
-                "without GIO-Unix features."), g_get_prgname ());
-
-  return FALSE;
-#endif
 }
 
 
-- 
1.8.0.2

