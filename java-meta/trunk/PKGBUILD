# Maintainer: Guillaume ALAUX <guillaume@archlinux.org>
pkgname=java-common
pkgver=1
pkgrel=1
pkgdesc='Common files for Java Environments'
arch=('any')
url='www.archlinux.org'
license=('GPL')
checkdepends=('wget')
backup=(etc/profile.d/jre.sh
        etc/profile.d/jre.csh)
# TODO rename
install=install_java-runtime-headless-meta.sh
source=(profile_jre.csh
        profile_jre.sh
        bin_archlinux-java
        bin_archlinux-java_tests
        bin_java-wrapper
        https://shunit2.googlecode.com/files/shunit2-2.1.6.tgz)

sha256sums=('9f0032e47705ce55a615ab3b942720b8447f490d1ff430b214038b81c3019ac2'
            '8dbafa311f34d23c5bbef71fa942b97b224ebeb330b36195f22a1836285bbb83'
            'd54f54e79ee8104783a12fa7e55f9826f80c26142b1d89a34ffe2529ed78d962'
            '90c1ca2f32aedf684048e1c072e03eff6b919a10b9b0e83b182186e7572d11c6'
            '622927af9ec374140a878993936f7fdd4206fe069dddfcefc6d4e15fa6d67f39'
            '65a313a76fd5cc1c58c9e19fbc80fc0e418a4cbfbd46d54b35ed5b6e0025d4ee')

check() {
  cd "${srcdir}"
  ./bin_archlinux-java_tests
}

build() {
  cd "${srcdir}"

  install -D -m 644 profile_jre.sh  "${pkgdir}/etc/profile.d/jre.sh"
  install -D -m 644 profile_jre.csh "${pkgdir}/etc/profile.d/jre.csh"
  # TODO change name
  install -D -m 755 bin_java-wrapper "${pkgdir}/usr/share/java-common-wrapper"
  install -D -m 755 bin_archlinux-java "${pkgdir}/usr/bin/archlinux-java"
}
